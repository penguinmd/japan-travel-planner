<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Japan Travel Itinerary</title>
    <link rel="stylesheet" href="styles.css">
    <!-- Leaflet CSS for interactive maps -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
        integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
        crossorigin=""/>
    <!-- Leaflet JavaScript -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
        integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
        crossorigin=""></script>
</head>
<body>
    <div class="container">
        <header>
            <h1>🇯🇵 Japan Travel Guide</h1>
            <p class="subtitle">Your Complete Itinerary & Travel Tips</p>
        </header>

        <div id="auth-container" style="background: var(--bg-secondary); border-radius: 12px; padding: 20px; margin-bottom: 20px; text-align: center; border: 1px solid var(--border);">
            <div id="logged-out-view">
                <p style="color: var(--text-primary); margin-bottom: 12px;">Enter the shared password to collaborate on this trip!</p>
                <input type="password" id="password-input" placeholder="Enter password"
                       style="padding: 12px; border-radius: 8px; border: 1px solid var(--border); background: var(--bg-tertiary); color: var(--text-primary); width: 300px; margin-right: 10px;">
                <button onclick="handleLogin(event)" class="nav-btn" style="padding: 12px 24px;">Login</button>
                <p id="auth-message" style="margin-top: 10px; font-size: 0.9em; color: var(--text-secondary);"></p>
            </div>
            <div id="logged-in-view" style="display: none;">
                <span style="color: var(--text-primary); margin-right: 20px;">Logged in and ready to plan!</span>
                <button onclick="handleLogout()" class="nav-btn" style="background: linear-gradient(135deg, #ff6b9d, #ff8fab);">Logout</button>
                <button onclick="saveData()" class="nav-btn" style="margin-left: 10px; background: linear-gradient(135deg, #00d4ff, #00e5ff);">Save Changes</button>
            </div>
        </div>

        <nav>
            <input type="text" class="search-box" id="searchBox" placeholder="🔍 Search destinations, food, tips...">
            <div class="nav-grid">
                <button class="nav-btn active" onclick="showSection('tips')">General Tips</button>
                <button class="nav-btn" onclick="showSection('trains')">Trains</button>
                <button class="nav-btn" onclick="showSection('tokyo')">Tokyo</button>
                <button class="nav-btn" onclick="showSection('kyoto')">Kyoto</button>
                <button class="nav-btn" onclick="showSection('kinosaki')">Kinosaki</button>
                <button class="nav-btn" onclick="showSection('osaka')">Osaka</button>
                <button class="nav-btn" onclick="showSection('kanazawa')">Kanazawa</button>
                <button class="nav-btn" onclick="showSection('itinerary-planner')">Itinerary</button>
                <button class="nav-btn" onclick="showSection('budget-tracker')">Budget</button>
            </div>
        </nav>

        <div class="main-layout">
            <!-- LEFT: Content Panel -->
            <div class="content-panel">
                <!-- GENERAL TIPS -->
                <section id="tips" class="content-section active">
            <h2>📋 General Tips</h2>

            <div class="tip-card">
                <strong>🚶 Always wander off the path</strong>
                Everything is amazing, and the best part is seeing new things that are not crowded by tons of people.
            </div>

            <div class="tip-card">
                <strong>🍽️ Restaurant Reservations - Tabelog</strong>
                In Japan they use <a href="https://tabelog.com" target="_blank">Tabelog</a> for restaurant reviews and reservations (not Yelp or Google). If you really want to go to a specific restaurant, try to get a reservation a few days before. You cannot get same-day reservations often.
            </div>

            <div class="tip-card">
                <strong>👟 Wear nice shoes, lots of walking</strong>
                Get a room with a bathtub - your body will thank you.
            </div>

            <div class="tip-card">
                <strong>🎒 Pack light</strong>
                Travel with a backpack to carry on the flight and a personal item. You'll be going up and down so many stairs that a roller-bag will probably suck.
            </div>

            <div class="tip-card">
                <strong>🪙 Getting rid of coins</strong>
                Go to a 7-11, buy something and throw all your coins in the slot. It will give you back change if you have more coins than the cost of the item.
            </div>

            <div class="tip-card">
                <strong>💴 No tipping anywhere</strong>
                Tipping is considered disrespectful.
            </div>

            <div class="tip-card">
                <strong>🤫 Be quiet on trains</strong>
                People prefer silence.
            </div>

            <div class="tip-card">
                <strong>🧴 Always have hand sanitizer</strong>
                Many bathrooms do not have soap.
            </div>

            <div class="tip-card">
                <strong>📱 GET GOOGLE TRANSLATE</strong>
                You can take pictures of menus, signs, or anything else to translate. You can also download the language so you can use it when you don't have service.
            </div>
        </section>

        <!-- TRAINS -->
        <section id="trains" class="content-section">
            <h2>🚄 Train Travel</h2>

            <div class="tip-card">
                <strong>📱 Download the Suica app</strong>
                The app is red with flowers. Set up your account and add it to your Apple Wallet. You can use Apple Pay to add money onto your Suica card which is used for trains and subways. It will show your remaining balance. You can also use your Suica funds at convenience stores like Apple Pay. <span class="highlight">Set this up during the flights there or before you leave.</span>
            </div>

            <div class="tip-card">
                <strong>🎫 Express Tickets & Reserved Seating</strong>
                Some trains have reserved seating and require an express ticket. You get into the station using your Suica but then need an express ticket. If you don't have a ticket yet, just get on board and buy a ticket from the attendant. <span class="highlight">Do not miss a train just because you don't have a ticket yet.</span> Worst case you end up standing instead of sitting.
            </div>

            <div class="tip-card">
                <strong>🗺️ Google Maps > Apple Maps</strong>
                Travel by train the entire trip. Google Maps will tell you which platform and car to take. Google Maps is better than Apple Maps.
            </div>
        </section>

        <!-- TOKYO -->
        <section id="tokyo" class="content-section">
            <h2>🗼 Tokyo</h2>

            <h3>🏙️ Areas to Explore</h3>

            <div class="location-card" data-location-index="0" onmouseover="highlightMapPin(0, 'tokyo')" onmouseout="unhighlightMapPin()">
                <strong><span class="location-number">1</span> Shinjuku</strong>
                Great area to stay. Love walking around and seeing all the lit-up streets.
                <br>
                <a href="https://www.google.com/maps/search/Shinjuku+Tokyo+Japan" target="_blank" class="map-link">📍 View on Map</a>
                <a href="https://www.shinjuku.tokyo/" target="_blank" class="website-link">🌐 Guide Website</a>
            </div>

            <div class="location-card" data-location-index="3" onmouseover="highlightMapPin(3, 'tokyo')" onmouseout="unhighlightMapPin()">
                <strong><span class="location-number">2</span> Imperial Palace & Gardens</strong>
                Lots of history, very pretty. Must visit.
                <br>
                <a href="https://www.google.com/maps/search/Imperial+Palace+Gardens+Tokyo+Japan" target="_blank" class="map-link">📍 View on Map</a>
                <a href="https://www.kunaicho.go.jp/e-event/higashigyoen.html" target="_blank" class="website-link">🌐 Official Website</a>
            </div>

            <div class="location-card" data-location-index="2" onmouseover="highlightMapPin(2, 'tokyo')" onmouseout="unhighlightMapPin()">
                <strong><span class="location-number">3</span> Shibuya Crossing</strong>
                Cool to see. If you love to shop brand names, it's a good area. Watch the crossing from the Magnet Building - go to the roof floor (pay a cover and get a drink). Also visit Shibuya Scramble Square for the foodie floor.
                <br>
                <a href="https://www.google.com/maps/search/Shibuya+Crossing+Tokyo+Japan" target="_blank" class="map-link">📍 View on Map</a>
                <a href="https://www.shibuyacrossing.com/" target="_blank" class="website-link">🌐 Guide Website</a>
            </div>

            <div class="location-card" data-location-index="4" onmouseover="highlightMapPin(4, 'tokyo')" onmouseout="unhighlightMapPin()">
                <strong><span class="location-number">4</span> Meiji Jingu Park</strong>
                Beautiful scenery and some shrines. Walk through on the way to Shibuya.
                <br>
                <a href="https://www.google.com/maps/search/Meiji+Jingu+Park+Tokyo+Japan" target="_blank" class="map-link">📍 View on Map</a>
                <a href="https://www.meijijingu.or.jp/en/" target="_blank" class="website-link">🌐 Official Website</a>
            </div>

            <div class="location-card" data-location-index="1" onmouseover="highlightMapPin(1, 'tokyo')" onmouseout="unhighlightMapPin()">
                <strong><span class="location-number">5</span> Golden Gai</strong>
                Tons of cool small bars that seat four to ten people. Different themes for each bar. <span class="highlight">Aces Bar recommended</span> - no cover and the owner is really nice.
                <br>
                <a href="https://tokyocheapo.com/food-and-drink/quick-guide-golden-gai/" target="_blank" class="map-link">📖 Guide</a>
                <a href="https://www.tripadvisor.com/Restaurant_Review-g14133667-d6180750-Reviews-Ace_s-Kabukicho_Shinjuku_Tokyo_Tokyo_Prefecture_Kanto.html" target="_blank" class="map-link">📍 Ace's Bar</a>
            </div>

            <h3>🏨 Hotel</h3>
            <div class="hotel-card" data-location-index="9" onmouseover="highlightMapPin(9, 'tokyo')" onmouseout="unhighlightMapPin()">
                <h4><span class="location-number">6</span> Hotel Gracery (Godzilla Head Hotel)</h4>
                Cool place with a nice location. Super small rooms, but fine because you're out a lot. Close to Omoide Yokocho.
                <br>
                <a href="https://maps.app.goo.gl/wB7UVL3vWLX8919p6" target="_blank" class="map-link">📍 View on Map</a>
                <a href="https://www.gracery.com/shinjuku/" target="_blank" class="website-link">🌐 Official Website</a>
            </div>

            <h3>🍜 Food</h3>

            <div class="food-card" data-location-index="12" onmouseover="highlightMapPin(12, 'tokyo')" onmouseout="unhighlightMapPin()">
                <h4><span class="location-number">7</span> Tsurutontan Udon Noodle Brasserie Shibuya</h4>
                Amazing udon place in the Shibuya Scramble Square.
                <br>
                <a href="https://www.tripadvisor.com/Restaurant_Review-g1066456-d19306932-Reviews-Tsurutontan_Udon_Noodle_Brasserie_Shibuya-Shibuya_Tokyo_Tokyo_Prefecture_Kanto.html" target="_blank" class="map-link">📍 View Details</a>
                <a href="https://www.tsurutontan.co.jp/" target="_blank" class="website-link">🌐 Official Website</a>
            </div>

            <div class="food-card" data-location-index="10" onmouseover="highlightMapPin(10, 'tokyo')" onmouseout="unhighlightMapPin()">
                <h4><span class="location-number">8</span> Omoide Yokocho</h4>
                <span class="highlight">YOU HAVE TO GO</span> - Best yakitori stalls. Two streets filled with different food stalls. You can bounce around or stay at one. Great place for pictures. 10/10 recommend. Come back here several times.
                <br>
                <a href="https://maps.app.goo.gl/mF5Cf91j3jeHTRUM6" target="_blank" class="map-link">📍 View on Map</a>
                <a href="https://www.shinjuku-omoide.com/" target="_blank" class="website-link">🌐 Guide Website</a>
            </div>

            <div class="food-card" data-location-index="11" onmouseover="highlightMapPin(11, 'tokyo')" onmouseout="unhighlightMapPin()">
                <h4><span class="location-number">9</span> Tsukiji Market</h4>
                Fish, desserts, steak, coffee, matcha, whatever you dream of... it's here. <span class="highlight">Go early.</span> So good.
                <br>
                <a href="https://www.google.com/maps/search/Tsukiji+Market+Tokyo+Japan" target="_blank" class="map-link">📍 View on Map</a>
                <a href="https://www.tsukiji.or.jp/english/" target="_blank" class="website-link">🌐 Official Website</a>
            </div>

            <div class="food-card" data-location-index="13" onmouseover="highlightMapPin(13, 'tokyo')" onmouseout="unhighlightMapPin()">
                <h4><span class="location-number">10</span> Yurakucho Kakida</h4>
                Amazing set sushi menu. About 15+ pieces of nigiri. Can feel a bit touristy, but amazing fish and you pay a set amount for food and drinks. They give you so much food - lots of variety. Then you get more pieces of your favorite fish at the end.
                <br>
                <a href="https://maps.app.goo.gl/WS9FgJU68kd6SrD1A" target="_blank" class="map-link">📍 View on Map</a>
                <a href="https://www.tripadvisor.com/Restaurant_Review-g1066444-d10123270-Reviews-Kakida_Yurakucho-Chiyoda_Tokyo_Tokyo_Prefecture_Kanto.html" target="_blank" class="website-link">🌐 View on TripAdvisor</a>
            </div>

            <div class="food-card" data-location-index="14" onmouseover="highlightMapPin(14, 'tokyo')" onmouseout="unhighlightMapPin()">
                <h4><span class="location-number">11</span> Fu-unji Ramen</h4>
                Waited one hour, but really good. Worth it. Lots of locals waiting in line.
                <br>
                <a href="https://www.fu-unji.com/" target="_blank" class="map-link">🌐 Website</a>
            </div>
        </section>

        <!-- KYOTO -->
        <section id="kyoto" class="content-section">
            <h2>⛩️ Kyoto</h2>

            <p style="background: #fff3cd; padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                Yes, it's touristy, but still worth seeing. <strong>Go to tourist sites early in the morning (5-6am)</strong> and then wander or relax the rest of the day without an agenda. Kyoto is broken down into different "districts": Gion, Fushimi Inari, and Arashiyama.
            </p>

            <h3>🏮 Gion District</h3>
            <span class="district-tag">Historic</span>
            <span class="district-tag">Temples</span>
            <span class="district-tag">Geisha</span>

            <div class="location-card" data-location-index="6" onmouseover="highlightMapPin(6, 'kyoto')" onmouseout="unhighlightMapPin()">
                <strong><span class="location-number">1</span> Hōkan-ji Temple (Yasaka Pagoda)</strong>
                Go early in the morning or at dusk for less people. Or make a reservation at K36 rooftop bar (long wait without reservation). You can see the Pagoda from the bar - photos and views are stunning.
                <br>
                <a href="https://maps.app.goo.gl/iz7h1MeE2zMN2UaM6" target="_blank" class="map-link">📍 View on Map</a>
                <a href="https://www.japan-guide.com/e/e3912.html" target="_blank" class="website-link">🌐 Guide Website</a>
            </div>

            <div class="location-card" data-location-index="7" onmouseover="highlightMapPin(7, 'kyoto')" onmouseout="unhighlightMapPin()" data-multi-location="true">
                <strong><span class="location-number">2</span> Famous Streets</strong>
                <ul>
                    <li data-location-index="7" onmouseover="highlightMapPin(7, 'kyoto')" onmouseout="unhighlightMapPin()"><strong>Hanamikoji Street</strong> - Famous Geisha street</li>
                    <li data-location-index="8" onmouseover="highlightMapPin(8, 'kyoto')" onmouseout="unhighlightMapPin()"><strong>Sannenzaka</strong></li>
                    <li data-location-index="9" onmouseover="highlightMapPin(9, 'kyoto')" onmouseout="unhighlightMapPin()"><strong>Ninenzaka</strong> - At the top of Ninenzaka, there's a building with three white umbrellas. Cool local guy paints miniature paintings for ~100 yen each. You should at least go see him!</li>
                </ul>
                Wander away from these streets to find cool shots, shops, and places to eat.
                <br>
                <a href="https://www.google.com/maps/search/Hanamikoji+Street+Kyoto+Japan" target="_blank" class="map-link">📍 Hanamikoji Street</a>
                <a href="https://www.google.com/maps/search/Sannenzaka+Kyoto+Japan" target="_blank" class="map-link">📍 Sannenzaka</a>
                <a href="https://www.google.com/maps/search/Ninenzaka+Kyoto+Japan" target="_blank" class="map-link">📍 Ninenzaka</a>
            </div>

            <div class="location-card" data-location-index="5" onmouseover="highlightMapPin(5, 'kyoto')" onmouseout="unhighlightMapPin()">
                <strong><span class="location-number">3</span> Kiyomizu-dera Temple</strong>
                Amazing temple that overlooks the city. Visit when you're in the Gion area.
                <br>
                <a href="https://maps.app.goo.gl/8g6NaHvfhuiJQRfh6" target="_blank" class="map-link">📍 View on Map</a>
                <a href="https://www.kiyomizudera.or.jp/en/" target="_blank" class="website-link">🌐 Official Website</a>
            </div>

            <p style="background: #f8f9ff; padding: 15px; border-radius: 8px; margin: 20px 0;">
                <strong>Pro Tip:</strong> Wake up early and get to the Gion neighborhood around 6am. It's so peaceful and nice to walk the empty streets without being shoulder to shoulder with people. <span class="highlight">GO EARLY AND GET IT DONE.</span> It's like a half day worth of stuff, all close together in one area.
            </p>

            <div class="location-card" data-location-index="4" onmouseover="highlightMapPin(4, 'kyoto')" onmouseout="unhighlightMapPin()">
                <strong><span class="location-number">4</span> Gion District</strong>
                Traditional entertainment district known for geishas and historic architecture.
                <br>
                <a href="https://www.google.com/maps/search/Gion+District+Kyoto+Japan" target="_blank" class="map-link">📍 View on Map</a>
                <a href="https://www.kyoto.travel/en/shrine_temple/104.html" target="_blank" class="website-link">🌐 Guide Website</a>
            </div>

            <div class="location-card" data-location-index="10" onmouseover="highlightMapPin(10, 'kyoto')" onmouseout="unhighlightMapPin()">
                <strong><span class="location-number">5</span> Nishiki Market</strong>
                Souvenirs, fish, meat, desserts, all in a market. Pretty cool to check out. Had some of the best clams and scallops - they're everywhere.
                <br>
                <a href="https://www.google.com/maps/search/Nishiki+Market+Kyoto+Japan" target="_blank" class="map-link">📍 View on Map</a>
                <a href="https://www.kyoto-nishiki.or.jp/stores/" target="_blank" class="website-link">🌐 Official Website</a>
            </div>

            <div class="location-card" data-location-index="11" onmouseover="highlightMapPin(11, 'kyoto')" onmouseout="unhighlightMapPin()">
                <strong><span class="location-number">6</span> Pontocho Alley</strong>
                Small alley way with a ton of cool restaurants and bars.
                <br>
                <a href="https://www.google.com/maps/search/Pontocho+District+Kyoto+Japan" target="_blank" class="map-link">📍 View on Map</a>
                <a href="https://www.ponto-chou.com/en/" target="_blank" class="website-link">🌐 Guide Website</a>
            </div>

            <h3>🏨 Hotel</h3>
            <div class="hotel-card" data-location-index="12" onmouseover="highlightMapPin(12, 'kyoto')" onmouseout="unhighlightMapPin()">
                <h4><span class="location-number">7</span> Crystal Gion Hotel</h4>
                Loved this hotel - affordable and in old town Gion. About 12-minute walk from Yasaka Pagoda. Close to subway/train station. Stayed four nights and went to other districts. Breakfast included!
                <br>
                <a href="https://www.google.com/maps/search/Crystal+Gion+Hotel+Kyoto+Japan" target="_blank" class="map-link">📍 View on Map</a>
                <a href="https://www.crystalhotels.jp/gion/" target="_blank" class="website-link">🌐 Official Website</a>
            </div>

            <h3>🍣 Food - Gion Area</h3>

            <div class="food-card" data-location-index="13" onmouseover="highlightMapPin(13, 'kyoto')" onmouseout="unhighlightMapPin()">
                <h4><span class="location-number">8</span> K36 Rooftop Bar</h4>
                Amazing rooftop bar with stunning views of Yasaka Pagoda. Make a reservation or expect a long wait.
                <br>
                <a href="https://www.google.com/maps/search/K36+Rooftop+Bar+Kyoto+Japan" target="_blank" class="map-link">📍 View on Map</a>
            </div>

            <div class="food-card" data-location-index="14" onmouseover="highlightMapPin(14, 'kyoto')" onmouseout="unhighlightMapPin()">
                <h4><span class="location-number">9</span> Hanamichi</h4>
                Cute lady runs this restaurant, and the food is so good.
                <br>
                <a href="https://maps.app.goo.gl/kRLaGHZK7Ca6pH7R7" target="_blank" class="map-link">📍 View on Map</a>
                <a href="https://www.tripadvisor.com/Restaurant_Review-g298564-d8786723-Reviews-Hanamichi-Kyoto_Kyoto_Prefecture_Kinki.html" target="_blank" class="website-link">🌐 View on TripAdvisor</a>
            </div>

            <div class="food-card" data-location-index="15" onmouseover="highlightMapPin(15, 'kyoto')" onmouseout="unhighlightMapPin()">
                <h4><span class="location-number">10</span> Lorimer Kyoto</h4>
                Wild brunch with fish and tons of random seasonal samples.
                <br>
                <a href="https://www.google.com/maps/search/Lorimer+Kyoto+Japan" target="_blank" class="map-link">📍 View on Map</a>
                <a href="https://lorimer-kyoto.com/" target="_blank" class="website-link">🌐 Official Website</a>
            </div>

            <div class="food-card" data-location-index="16" onmouseover="highlightMapPin(16, 'kyoto')" onmouseout="unhighlightMapPin()">
                <h4><span class="location-number">11</span> Sushi and Bar Spot</h4>
                Near Gion hotel. $100 omakase with a bar that seats about ten people. <span class="highlight">100% recommend.</span> Fish and sushi chef were amazing.
                <br>
                <a href="https://maps.app.goo.gl/boHjxe9wTS6c5oBD6" target="_blank" class="map-link">📍 View on Map</a>
                <a href="https://www.tripadvisor.com/Restaurant_Review-g298564-d10814943-Reviews-Sushi_Bar_Spot-Kyoto_Kyoto_Prefecture_Kinki.html" target="_blank" class="website-link">🌐 View on TripAdvisor</a>
            </div>

            <div class="food-card" data-location-index="17" onmouseover="highlightMapPin(17, 'kyoto')" onmouseout="unhighlightMapPin()">
                <h4><span class="location-number">12</span> Pontocho-noichi (Kobe Beef)</h4>
                Pricey, but if you want certified Kobe beef, this is a good spot for it.
                <br>
                <a href="https://kisshokichi-kyoto.com/pontochonoichi/" target="_blank" class="map-link">🌐 Website</a>
            </div>

            <h3>🎋 Arashiyama District</h3>
            <span class="district-tag">Bamboo Forest</span>
            <span class="district-tag">Nature</span>
            <span class="district-tag">Monkeys</span>

            <div class="location-card" data-location-index="2" onmouseover="highlightMapPin(2, 'kyoto')" onmouseout="unhighlightMapPin()">
                <strong><span class="location-number">13</span> Arashiyama Bamboo Grove</strong>
                Bamboo forest has a cool park on the side that's way better than the bamboo forest itself. Walk down along the water if you keep going south past the park - so pretty and highly recommend. Lots of shops and restaurants. Got beers and walked around.
                <a href="https://www.google.com/maps/search/Arashiyama+Bamboo+Grove+Kyoto+Japan" target="_blank" class="map-link">📍 View on Map</a>
            </div>

            <div class="location-card" data-location-index="3" onmouseover="highlightMapPin(3, 'kyoto')" onmouseout="unhighlightMapPin()">
                <strong><span class="location-number">14</span> Monkey Park Iwatayama</strong>
                Hike up the mountain to an overlook of the city. Beautiful views and free-roaming monkeys.
                <a href="https://www.google.com/maps/search/Monkey+Park+Iwatayama+Kyoto+Japan" target="_blank" class="map-link">📍 View on Map</a>
            </div>

            <div class="food-card" data-location-index="18" onmouseover="highlightMapPin(18, 'kyoto')" onmouseout="unhighlightMapPin()">
                <h4><span class="location-number">15</span> Taisho Hanana - Sea Bream Sashimi</h4>
                <span class="highlight">YOU HAVE TO GO TO.</span> So good. There will probably be a line but grab a beer from a 7-11 and wait in line. It is so worth it.
                <br>
                <a href="https://maps.app.goo.gl/XEGE148kmfDx5Jdu8" target="_blank" class="map-link">📍 View on Map</a>
                <a href="https://www.tripadvisor.com/Restaurant_Review-g298564-d10527791-Reviews-Taisho_Hanana-Kyoto_Kyoto_Prefecture_Kinki.html" target="_blank" class="website-link">🌐 View on TripAdvisor</a>
            </div>

            <h3>🏯 Golden Pavilion Area</h3>
            <div class="location-card" data-location-index="1" onmouseover="highlightMapPin(1, 'kyoto')" onmouseout="unhighlightMapPin()">
                <strong><span class="location-number">16</span> Kinkaku-ji (Golden Pavilion)</strong>
                Stunning golden temple surrounded by beautiful gardens. A must-see in Kyoto.
                <a href="https://www.google.com/maps/search/Kinkaku-ji+Golden+Pavilion+Kyoto+Japan" target="_blank" class="map-link">📍 View on Map</a>
            </div>

            <h3>🦊 Fushimi Inari District</h3>
            <span class="district-tag">Torii Gates</span>
            <span class="district-tag">Shrine</span>
            <span class="district-tag">Hiking</span>

            <div class="location-card" data-location-index="0" onmouseover="highlightMapPin(0, 'kyoto')" onmouseout="unhighlightMapPin()">
                <strong><span class="location-number">17</span> Fushimi Inari Shrine</strong>
                Loved it! Uphill hike with tons of orange torii gates. Super busy with tourists, but there are paths you can go down that are less crowded. Look for areas with random torii gates and no one around. Found abandoned areas where we were completely alone. Look for paths marked "not a through loop" - they turn into cool hikes that pop out into residential areas. Tons of street food and shops at the bottom.
                <a href="https://www.google.com/maps/search/Fushimi+Inari+Shrine+Kyoto+Japan" target="_blank" class="map-link">📍 View on Map</a>
            </div>

            <div class="food-card" data-location-index="20" onmouseover="highlightMapPin(20, 'kyoto')" onmouseout="unhighlightMapPin()">
                <h4><span class="location-number">18</span> Inari Douhachi Udon</h4>
                Really good and cheap udon in Fushimi Inari area.
                <br>
                <a href="https://maps.app.goo.gl/wdDCpFcVHFu63qVF8" target="_blank" class="map-link">📍 View on Map</a>
                <a href="https://www.tripadvisor.com/Restaurant_Review-g298564-d6644613-Reviews-Inari_Douhachi-Kyoto_Kyoto_Prefecture_Kinki.html" target="_blank" class="website-link">🌐 View on TripAdvisor</a>
            </div>
        </section>

        <!-- KINOSAKI -->
        <section id="kinosaki" class="content-section">
            <h2>♨️ Kinosaki</h2>

            <p style="background: #fff3cd; padding: 15px; border-radius: 8px; margin-bottom: 20px; font-size: 1.1em;">
                <strong>One of my favorite places in Japan. Seriously, you have to go.</strong> It's an onsen town with seven public onsens that are gender separated. You could book a private onsen for ~$60. Did not want to leave. So calm and quiet. Beautiful scenery.
            </p>

            <div class="location-card" data-location-index="0" onmouseover="highlightMapPin(0, 'kinosaki')" onmouseout="unhighlightMapPin()">
                <strong><span class="location-number">1</span> Kinosaki Onsen Town</strong>
                Traditional hot springs town with seven public onsens. Beautiful scenery and peaceful atmosphere.
                <br>
                <a href="https://www.google.com/maps/search/Kinosaki+Onsen+Town+Japan" target="_blank" class="map-link">📍 View on Map</a>
                <a href="https://www.kinosaki-spa.gr.jp/global/" target="_blank" class="website-link">🌐 Official Website</a>
            </div>

            <div class="hotel-card" data-location-index="2" onmouseover="highlightMapPin(2, 'kinosaki')" onmouseout="unhighlightMapPin()">
                <h4><span class="location-number">3</span> Nishimuraya Hotel</h4>
                Spent more at this onsen hotel that had two of its own private onsens in the lobby with a sauna and cold plunge. Stayed two nights. This was a lifesaver after walking around Kyoto and Tokyo - our bodies were hurting. This town is quiet and sooo pretty. It's pricey, but you won't regret it. The chef's seasonal dinner was one of the best meals we had.
                <br><br>
                <strong>Recommendation:</strong> Do two nights at Nishimuraya Hotel and then move to another hotel in town for another night or two. Loved being able to relax and not run all over the place.
                <br>
                <a href="https://www.google.com/maps/search/Nishimuraya+Hotel+Kinosaki+Japan" target="_blank" class="map-link">📍 View on Map</a>
                <a href="https://www.nishimuraya.ne.jp/shogetsu/en/" target="_blank" class="website-link">🌐 Official Website</a>
            </div>

            <h3>🏔️ Activities</h3>

            <div class="location-card" data-location-index="1" onmouseover="highlightMapPin(1, 'kinosaki')" onmouseout="unhighlightMapPin()">
                <strong><span class="location-number">2</span> Kinosaki Ropeway</strong>
                Took a cable car up to the top of the mountain and walked down. There's a café at the top where you can get coffees, beers, and hot dogs (hot dogs are a big thing in Japan).
                <a href="https://www.google.com/maps/search/Kinosaki+Onsen+Ropeway+Cable+Car+Japan" target="_blank" class="map-link">📍 View on Map</a>
            </div>

            <h3>🍕 Food</h3>

            <div class="food-card" data-location-index="3" onmouseover="highlightMapPin(3, 'kinosaki')" onmouseout="unhighlightMapPin()">
                <h4><span class="location-number">4</span> Gina Pizza</h4>
                A great Italian place with some great pasta and pizza.
                <br>
                <a href="https://www.google.com/maps/place/462+Kinosakich%C5%8D+Yushima,+Toyooka,+Hyogo+669-6101,+Japan/@35.6254376,134.806381,17z" target="_blank" class="map-link">📍 View on Map</a>
                <a href="https://www.tripadvisor.com/Restaurant_Review-g1023600-d10109576-Reviews-Gina_Pizza-Toyooka_Hyogo_Prefecture_Kinki.html" target="_blank" class="website-link">🌐 View on TripAdvisor</a>
            </div>

            <div class="food-card" data-location-index="4" onmouseover="highlightMapPin(4, 'kinosaki')" onmouseout="unhighlightMapPin()">
                <h4><span class="location-number">5</span> Cable Car Mountain Cafe</h4>
                Cafe at the top of the mountain with great views and refreshments.
                <br>
                <a href="https://www.google.com/maps/search/Kinosaki+Cable+Car+Mountain+Cafe+Japan" target="_blank" class="map-link">📍 View on Map</a>
                <a href="https://kinosaki-ropeway.jp/" target="_blank" class="website-link">🌐 Ropeway Website</a>
            </div>
        </section>

        <!-- OSAKA -->
        <section id="osaka" class="content-section">
            <h2>🏯 Osaka</h2>

            <p style="background: #f8f9ff; padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                Stay in the <strong>Namba area</strong> if you want to be close to Dotonburi and Kuromon Market. Amazing city to eat a lot of good food. They have whale sharks at the aquarium (buy tickets in advance or wait ~2 hours).
            </p>

            <div class="location-card" data-location-index="1" onmouseover="highlightMapPin(1, 'osaka')" onmouseout="unhighlightMapPin()">
                <strong><span class="location-number">1</span> Osaka Castle</strong>
                Historic castle with beautiful grounds and city views.
                <br>
                <a href="https://www.google.com/maps/search/Osaka+Castle+Japan" target="_blank" class="map-link">📍 View on Map</a>
                <a href="https://www.osakacastle.net/english/" target="_blank" class="website-link">🌐 Official Website</a>
            </div>

            <div class="location-card" data-location-index="2" onmouseover="highlightMapPin(2, 'osaka')" onmouseout="unhighlightMapPin()">
                <strong><span class="location-number">2</span> Shinsekai</strong>
                Retro entertainment district with unique architecture and local atmosphere.
                <br>
                <a href="https://www.google.com/maps/search/Shinsekai+Osaka+Japan" target="_blank" class="map-link">📍 View on Map</a>
                <a href="https://www.osaka-info.jp/en/page/shinsekai" target="_blank" class="website-link">🌐 Guide Website</a>
            </div>

            <div class="location-card" data-location-index="4" onmouseover="highlightMapPin(4, 'osaka')" onmouseout="unhighlightMapPin()">
                <strong><span class="location-number">3</span> Namba</strong>
                Shopping and entertainment district, great central location.
                <br>
                <a href="https://www.google.com/maps/search/Namba+Osaka+Japan" target="_blank" class="map-link">📍 View on Map</a>
                <a href="https://www.osaka-info.jp/en/page/namba-district" target="_blank" class="website-link">🌐 Guide Website</a>
            </div>

            <div class="hotel-card" data-location-index="5" onmouseover="highlightMapPin(5, 'osaka')" onmouseout="unhighlightMapPin()">
                <h4><span class="location-number">4</span> APA Namba Ekimae Hotel</h4>
                Too many people, heat wouldn't turn off. Super small room, but barely there so it was fine. Would not book here again at this specific hotel but loved the location. If you can stay in this area, you should.
                <br>
                <a href="https://www.google.com/maps/search/APA+Namba+Ekamai+Hotel+Osaka+Japan" target="_blank" class="map-link">📍 View on Map</a>
                <a href="https://www.apahotel.com/hotel/kansai/osaka/namba-ekimae/" target="_blank" class="website-link">🌐 Official Website</a>
            </div>

            <h3>🍢 Dotonburi (Insane Food District)</h3>
            <span class="district-tag">Street Food</span>
            <span class="district-tag">Must Visit</span>

            <div class="location-card" data-location-index="0" onmouseover="highlightMapPin(0, 'osaka')" onmouseout="unhighlightMapPin()">
                <strong><span class="location-number">5</span> Dotonbori</strong>
                Ended up spending a lot of time here because of all the amazing food options.
                <br>
                <a href="https://www.google.com/maps/search/Dotonbori+Osaka+Japan" target="_blank" class="map-link">📍 View on Map</a>
                <a href="https://www.osaka-info.jp/en/page/dotonbori" target="_blank" class="website-link">🌐 Guide Website</a>
            </div>

            <div class="food-card" data-location-index="6" onmouseover="highlightMapPin(6, 'osaka')" onmouseout="unhighlightMapPin()">
                <h4><span class="location-number">6</span> Teppan Jinja (Teppan-grilled skewers)</h4>
                <span class="highlight">MUST TRY</span> - Seriously so good if you want different beef, chicken, pork options. <strong>Went here twice because the hype is real.</strong>
                <br>
                <a href="https://maps.app.goo.gl/oZA1gKZa3yrzASRz8" target="_blank" class="map-link">📍 View on Map</a>
                <a href="https://www.tripadvisor.com/Restaurant_Review-g298566-d17417674-Reviews-Teppan_Jinja-Osaka_Osaka_Prefecture_Kinki.html" target="_blank" class="website-link">🌐 View on TripAdvisor</a>
            </div>

            <h3>🐟 Osaka Kuromon Market</h3>
            <span class="district-tag">Best Market Ever</span>
            <span class="district-tag">Fresh Fish</span>

            <div class="location-card" data-location-index="3" onmouseover="highlightMapPin(3, 'osaka')" onmouseout="unhighlightMapPin()">
                <strong><span class="location-number">7</span> Kuromon Market</strong>
                Amazing market with fresh fish, street food, and local specialties. Can't go wrong with the food here. <strong>Takoyaki and pufferfish are huge here.</strong>
                <br>
                <a href="https://www.google.com/maps/search/Kuromon+Market+Osaka+Japan" target="_blank" class="map-link">📍 View on Map</a>
                <a href="https://kuromon.com/en/" target="_blank" class="website-link">🌐 Official Website</a>
            </div>

            <div class="food-card" data-location-index="7" onmouseover="highlightMapPin(7, 'osaka')" onmouseout="unhighlightMapPin()">
                <h4><span class="location-number">8</span> Suehiro Sushi (Kuromon)</h4>
                Great sushi and hand rolls. Has a grab-and-go or sit down at the bar.
                <br>
                <a href="https://maps.app.goo.gl/KLm6x9DAAkLwQVFR9" target="_blank" class="map-link">📍 View on Map</a>
                <a href="https://www.tripadvisor.com/Restaurant_Review-g298566-d7096853-Reviews-Suehiro-Osaka_Osaka_Prefecture_Kinki.html" target="_blank" class="website-link">🌐 View on TripAdvisor</a>
                <br>
                <small>21-33, Nippombashi 1-Chōme, Chuo, Osaka</small>
            </div>

            <div class="food-card" data-location-index="8" onmouseover="highlightMapPin(8, 'osaka')" onmouseout="unhighlightMapPin()">
                <h4><span class="location-number">9</span> Entoki Kuromon (Best Tuna)</h4>
                <span class="highlight">BEST TUNA</span> - Serves nigiri sampler of different parts of the tuna. <strong>This booth will live in my mind and heart until the end of time.</strong>
                <br>
                <a href="https://maps.app.goo.gl/M8eTX6B1BPgQPQSa6" target="_blank" class="map-link">📍 View on Map</a>
                <a href="https://entoki.com/" target="_blank" class="map-link">🌐 Website</a>
            </div>

            <p style="margin-top: 15px;">Ate at so many stalls. The above two were favorites. Everything else was good, but not as amazing as those.</p>
        </section>

        <!-- KANAZAWA -->
        <section id="kanazawa" class="content-section">
            <h2>🏰 Kanazawa</h2>

            <p style="background: #fff3cd; padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                <strong>Would go back to Kanazawa again.</strong> It's beautiful and is like a less crowded Kyoto. If you don't want to go to a tourist city, go here! There's a massive castle in the middle of the city - Kanazawa Castle. You can tour different parts of it and buy tickets to a garden next to it that is stunning.
            </p>

            <div class="location-card" data-location-index="0" onmouseover="highlightMapPin(0, 'kanazawa')" onmouseout="unhighlightMapPin()">
                <strong><span class="location-number">1</span> Kenrokuen Garden</strong>
                One of Japan's three most beautiful gardens. Stunning scenery and peaceful atmosphere.
                <br>
                <a href="https://www.google.com/maps/search/Kenrokuen+Garden+Kanazawa+Japan" target="_blank" class="map-link">📍 View on Map</a>
                <a href="https://www.pref.ishikawa.jp/siro-niwa/kenrokuen/e/" target="_blank" class="website-link">🌐 Official Website</a>
            </div>

            <div class="location-card" data-location-index="1" onmouseover="highlightMapPin(1, 'kanazawa')" onmouseout="unhighlightMapPin()">
                <strong><span class="location-number">2</span> Kanazawa Castle</strong>
                Tour the castle and visit the stunning garden next to it.
                <br>
                <a href="https://maps.app.goo.gl/PfDwtB21FuRiFfae8" target="_blank" class="map-link">📍 View on Map</a>
                <a href="https://www.pref.ishikawa.jp/siro-niwa/kanazawajou/e/" target="_blank" class="website-link">🌐 Official Website</a>
            </div>

            <div class="location-card" data-location-index="3" onmouseover="highlightMapPin(3, 'kanazawa')" onmouseout="unhighlightMapPin()">
                <strong><span class="location-number">3</span> Omicho Market</strong>
                Fresh seafood market with great local food stalls and restaurants.
                <br>
                <a href="https://www.google.com/maps/search/Omicho+Market+Kanazawa+Japan" target="_blank" class="map-link">📍 View on Map</a>
                <a href="https://ohmicho-ichiba.com/" target="_blank" class="website-link">🌐 Official Website</a>
            </div>

            <div class="location-card" data-location-index="4" onmouseover="highlightMapPin(4, 'kanazawa')" onmouseout="unhighlightMapPin()">
                <strong><span class="location-number">4</span> 21st Century Museum</strong>
                Contemporary art museum with unique installations and exhibits.
                <br>
                <a href="https://www.google.com/maps/search/21st+Century+Museum+Kanazawa+Japan" target="_blank" class="map-link">📍 View on Map</a>
                <a href="https://www.kanazawa21.jp/en/" target="_blank" class="website-link">🌐 Official Website</a>
            </div>

            <h3>🏨 Hotel</h3>
            <div class="hotel-card" data-location-index="5" onmouseover="highlightMapPin(5, 'kanazawa')" onmouseout="unhighlightMapPin()">
                <h4><span class="location-number">5</span> Tokyu Stay Kanazawa</h4>
                Loved it and it was super affordable. The location was good too.
                <br>
                <a href="https://www.google.com/maps/search/Tokyu+Stay+Kanazawa+Japan" target="_blank" class="map-link">📍 View on Map</a>
                <a href="https://www.tokyustay.co.jp/e/hotel/KZW/" target="_blank" class="website-link">🌐 Official Website</a>
            </div>

            <h3>🍷 Food & Drink</h3>

            <div class="food-card" data-location-index="6" onmouseover="highlightMapPin(6, 'kanazawa')" onmouseout="unhighlightMapPin()">
                <h4><span class="location-number">6</span> Uva Uva (Italian/Japanese Fusion)</h4>
                Found this place wandering. Italian/Japanese fusion with set menu and seasonal ingredients. Italian sashimi and tempura. Squid pomodoro was good. The owner is a cute lady who is a sommelier and showed great wines.
                <br>
                <a href="https://uvauva-romanza.jp" target="_blank" class="map-link">🌐 Website</a>
                <a href="https://maps.app.goo.gl/tWkANjJui7gXxfE69" target="_blank" class="map-link">📍 View on Map</a>
            </div>

            <div class="food-card" data-location-index="7" onmouseover="highlightMapPin(7, 'kanazawa')" onmouseout="unhighlightMapPin()">
                <h4><span class="location-number">7</span> Ramen Mikoshi</h4>
                Was okay.
                <br>
                <a href="https://maps.app.goo.gl/eNz3MgzFC1qVyQVEA" target="_blank" class="map-link">📍 View on Map</a>
                <a href="https://www.tripadvisor.com/Restaurant_Review-g298113-d7063733-Reviews-Mikoshi-Kanazawa_Ishikawa_Prefecture_Hokuriku_Chubu.html" target="_blank" class="website-link">🌐 View on TripAdvisor</a>
            </div>

            <div class="food-card" data-location-index="8" onmouseover="highlightMapPin(8, 'kanazawa')" onmouseout="unhighlightMapPin()">
                <h4><span class="location-number">8</span> Furansu Cocktail Bar</h4>
                <a href="https://maps.app.goo.gl/9VQVbYkng9vMkxoJ6" target="_blank" class="map-link">📍 View on Map</a>
                <a href="https://www.tripadvisor.com/Restaurant_Review-g298113-d3850653-Reviews-Furansu-Kanazawa_Ishikawa_Prefecture_Hokuriku_Chubu.html" target="_blank" class="website-link">🌐 View on TripAdvisor</a>
            </div>

            <h3>🍶 Higashi Chaya District</h3>
            <span class="district-tag">Old Town</span>
            <span class="district-tag">Sake</span>

            <div class="location-card" data-location-index="2" onmouseover="highlightMapPin(2, 'kanazawa')" onmouseout="unhighlightMapPin()">
                <strong><span class="location-number">9</span> Higashi Chaya District</strong>
                An old town district with shops, bars, and restaurants. There's a river that runs by it that's beautiful to walk down. Did a sake tasting and got Donburi bowls.
                <a href="https://www.google.com/maps/search/Higashi+Chaya+District+Kanazawa+Japan" target="_blank" class="map-link">📍 View on Map</a>
            </div>

            <div class="food-card" data-location-index="9" onmouseover="highlightMapPin(9, 'kanazawa')" onmouseout="unhighlightMapPin()">
                <h4><span class="location-number">10</span> Fukumitsuya Higashi (Sake Bar)</h4>
                <a href="https://maps.app.goo.gl/dkmm6chdRkLFs9cF8" target="_blank" class="map-link">📍 View on Map</a>
                <a href="https://www.fukumitsuya.co.jp/english/" target="_blank" class="website-link">🌐 Official Website</a>
            </div>

            <div class="food-card" data-location-index="10" onmouseover="highlightMapPin(10, 'kanazawa')" onmouseout="unhighlightMapPin()">
                <h4><span class="location-number">11</span> Higashiyama Yoshi (Donburi Bowls)</h4>
                So good!
                <br>
                <a href="https://maps.app.goo.gl/MqEARfKoKxf56u6h9" target="_blank" class="map-link">📍 View on Map</a>
                <a href="https://www.tripadvisor.com/Restaurant_Review-g298113-d10425859-Reviews-Higashiyama_Yoshi-Kanazawa_Ishikawa_Prefecture_Hokuriku_Chubu.html" target="_blank" class="website-link">🌐 View on TripAdvisor</a>
            </div>
        </section>
            </div>
            <!-- End of Content Panel -->

            <!-- RIGHT: Map Panel (sticky) -->
            <div class="map-panel">
                <div class="map-header">
                    <h3 class="map-title" id="map-title">Japan Overview</h3>
                    <p class="map-subtitle" id="map-subtitle">Select a city to view locations</p>

                    <!-- Map Filters -->
                    <div class="map-filters" style="display: flex; gap: 12px; margin-top: 12px; flex-wrap: wrap;">
                        <label class="filter-checkbox" style="display: flex; align-items: center; gap: 6px; cursor: pointer; font-size: 0.9em;">
                            <input type="checkbox" checked onchange="toggleMapFilter('locations')" style="cursor: pointer;">
                            <span style="width: 12px; height: 12px; background: #7d8f69; border-radius: 50%; display: inline-block;"></span>
                            <span>Attractions</span>
                        </label>
                        <label class="filter-checkbox" style="display: flex; align-items: center; gap: 6px; cursor: pointer; font-size: 0.9em;">
                            <input type="checkbox" checked onchange="toggleMapFilter('hotels')" style="cursor: pointer;">
                            <span style="width: 12px; height: 12px; background: #5d5d81; border-radius: 50%; display: inline-block;"></span>
                            <span>Hotels</span>
                        </label>
                        <label class="filter-checkbox" style="display: flex; align-items: center; gap: 6px; cursor: pointer; font-size: 0.9em;">
                            <input type="checkbox" checked onchange="toggleMapFilter('restaurants')" style="cursor: pointer;">
                            <span style="width: 12px; height: 12px; background: #d4a5a5; border-radius: 50%; display: inline-block;"></span>
                            <span>Restaurants</span>
                        </label>
                    </div>
                </div>
                <div id="main-map" class="map-container"></div>
            </div>
        </div>
        <!-- End of Main Layout -->
    </div>

    <script>
        function showSection(sectionId) {
            // Hide all sections
            const sections = document.querySelectorAll('.content-section');
            sections.forEach(section => {
                section.classList.remove('active');
            });

            // Remove active class from all buttons
            const buttons = document.querySelectorAll('.nav-btn');
            buttons.forEach(button => {
                button.classList.remove('active');
            });

            // Show selected section
            document.getElementById(sectionId).classList.add('active');

            // Add active class to clicked button
            event.target.classList.add('active');

            // Update map for the selected section
            updateMapForSection(sectionId);

            // Scroll to top
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function updateMapForSection(sectionId) {
            const cityMap = {
                'tokyo': 'tokyo',
                'kyoto': 'kyoto',
                'osaka': 'osaka',
                'kinosaki': 'kinosaki',
                'kanazawa': 'kanazawa'
            };

            const mapTitle = document.getElementById('map-title');
            const mapSubtitle = document.getElementById('map-subtitle');

            if (cityMap[sectionId]) {
                const cityName = sectionId.charAt(0).toUpperCase() + sectionId.slice(1);
                mapTitle.textContent = `${cityName} Locations`;

                const locations = cityLocations[sectionId];
                mapSubtitle.textContent = `${locations.length} places to visit`;

                updateMapForCity(sectionId);
            } else {
                // Non-city sections (tips, trains, itinerary-planner, budget-tracker)
                mapTitle.textContent = 'Japan Overview';
                mapSubtitle.textContent = 'Select a city to view locations';

                // Reset to Japan overview
                if (mainMapInstance) {
                    mainMapInstance.flyTo([36.2048, 138.2529], 6, {
                        duration: 1.5,
                        easeLinearity: 0.25
                    });
                    currentCityMarkers.forEach(marker => marker.remove());
                    currentCityMarkers = [];
                }
            }
        }

        // Search functionality
        const searchBox = document.getElementById('searchBox');
        searchBox.addEventListener('input', function(e) {
            const searchTerm = e.target.value.toLowerCase();
            const sections = document.querySelectorAll('.content-section');

            if (searchTerm === '') {
                // Reset to show only tips section if search is empty
                sections.forEach(section => section.classList.remove('active'));
                document.getElementById('tips').classList.add('active');
                return;
            }

            sections.forEach(section => {
                const content = section.textContent.toLowerCase();
                if (content.includes(searchTerm)) {
                    section.classList.add('active');
                } else {
                    section.classList.remove('active');
                }
            });
        });
    </script>
    <script src="config.js"></script>
    <script src="supabase-data.js"></script>
    <script src="auth.js"></script>
    <script src="ui-components.js"></script>
    <script src="itinerary.js"></script>
    <script src="budget.js"></script>
    <script src="photos.js"></script>
    <script src="maps.js"></script>
    <script src="map-interactions.js"></script>
    <script>
        async function handleLogin(event) {
            const passwordInput = document.getElementById('password-input');
            const authMessage = document.getElementById('auth-message');
            const button = event.target;
            const password = passwordInput.value;

            if (!password) {
                authMessage.textContent = 'Please enter the password';
                authMessage.style.color = 'var(--accent-secondary)';
                return;
            }

            // Add loading state - disable button and show "Logging in..."
            const originalText = button.textContent;
            button.disabled = true;
            button.textContent = 'Logging in...';

            try {
                await auth.login(password);
                authMessage.textContent = 'Successfully logged in!';
                authMessage.style.color = 'var(--accent-primary)';
                passwordInput.value = '';

                // Load data after successful login
                await loadData();
            } catch (error) {
                authMessage.textContent = `Error: ${error.message}`;
                authMessage.style.color = 'var(--accent-secondary)';
            } finally {
                // Re-enable button and restore text
                button.disabled = false;
                button.textContent = originalText;
            }
        }

        async function handleLogout() {
            try {
                await auth.logout();
            } catch (error) {
                alert(`Error logging out: ${error.message}`);
            }
        }

        async function loadData() {
            try {
                await dataManager.load();
                console.log('Data loaded successfully:', dataManager.data);
                renderUI();
            } catch (error) {
                console.error('Failed to load data:', error);
                alert('Failed to load data. Make sure the repository exists and you have access.');
            }
        }

        async function saveData() {
            if (!auth.isAuthenticated()) {
                alert('Please log in to save changes');
                return;
            }

            try {
                await dataManager.save();
                alert('Changes saved successfully!');
            } catch (error) {
                alert(`Error saving: ${error.message}`);
            }
        }

        function renderUI() {
            if (!dataManager.data) return;
            addInteractiveFeatures();
            renderAllBudgetCategories();

            // Render all photos
            document.querySelectorAll('.location-card, .food-card, .hotel-card').forEach(card => {
                const titleElement = card.querySelector('strong, h4');
                if (!titleElement) return;

                const locationId = titleElement.textContent
                    .toLowerCase()
                    .replace(/[^a-z0-9]+/g, '-')
                    .replace(/^-|-$/g, '');

                renderPhotosForLocation(locationId);
            });
        }

        // Initialize on page load
        window.addEventListener('DOMContentLoaded', async () => {
            // Initialize auth FIRST
            await auth.init();

            // Initialize data AFTER auth is ready
            if (auth.isAuthenticated()) {
                await loadData();

                // Subscribe to storage changes (for syncing across tabs)
                dataManager.subscribeToChanges((newData) => {
                    console.log('Data synced from another tab');
                    // Refresh UI with new data
                    renderUI();
                });
            }

            // Add itinerary section after Kanazawa section
            const kanazawaSection = document.getElementById('kanazawa');
            const itinerarySection = createItinerarySection();
            kanazawaSection.parentNode.insertBefore(itinerarySection, kanazawaSection.nextSibling);

            // Add budget section after itinerary section
            const budgetSection = createBudgetSection();
            itinerarySection.parentNode.insertBefore(budgetSection, itinerarySection.nextSibling);
        });
    </script>
</body>
</html>
