<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Japan Travel Itinerary</title>
    <link rel="stylesheet" href="styles.css">
    <!-- Leaflet CSS for interactive maps -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
        integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
        crossorigin=""/>
    <!-- Leaflet JavaScript -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
        integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
        crossorigin=""></script>
    <!-- Supabase SDK -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸ‡¯ğŸ‡µ Japan Travel Guide</h1>
            <p class="subtitle">Your Complete Itinerary & Travel Tips</p>
        </header>

        <div id="auth-container" style="background: var(--bg-secondary); border-radius: 12px; padding: 20px; margin-bottom: 20px; text-align: center; border: 1px solid var(--border);">
            <div id="logged-out-view">
                <p style="color: var(--text-primary); margin-bottom: 12px;">Login to collaborate on this trip!</p>
                <input type="email" id="email-input" placeholder="Enter your email"
                       style="padding: 12px; border-radius: 8px; border: 1px solid var(--border); background: var(--bg-tertiary); color: var(--text-primary); width: 300px; margin-right: 10px;">
                <button onclick="handleLogin(event)" class="nav-btn" style="padding: 12px 24px;">Send Magic Link</button>
                <p id="auth-message" style="margin-top: 10px; font-size: 0.9em; color: var(--text-secondary);"></p>
            </div>
            <div id="logged-in-view" style="display: none;">
                <span id="user-email" style="color: var(--text-primary); margin-right: 20px;"></span>
                <button onclick="handleLogout()" class="nav-btn" style="background: linear-gradient(135deg, #ff6b9d, #ff8fab);">Logout</button>
                <button onclick="saveData()" class="nav-btn" style="margin-left: 10px; background: linear-gradient(135deg, #00d4ff, #00e5ff);">Save Changes</button>
            </div>
        </div>

        <nav>
            <input type="text" class="search-box" id="searchBox" placeholder="ğŸ” Search destinations, food, tips...">
            <div class="nav-grid">
                <button class="nav-btn active" onclick="showSection('tips')">General Tips</button>
                <button class="nav-btn" onclick="showSection('trains')">Trains</button>
                <button class="nav-btn" onclick="showSection('tokyo')">Tokyo</button>
                <button class="nav-btn" onclick="showSection('kyoto')">Kyoto</button>
                <button class="nav-btn" onclick="showSection('kinosaki')">Kinosaki</button>
                <button class="nav-btn" onclick="showSection('osaka')">Osaka</button>
                <button class="nav-btn" onclick="showSection('kanazawa')">Kanazawa</button>
                <button class="nav-btn" onclick="showSection('itinerary-planner')">Itinerary</button>
                <button class="nav-btn" onclick="showSection('budget-tracker')">Budget</button>
            </div>
        </nav>

        <div class="main-layout">
            <!-- LEFT: Content Panel -->
            <div class="content-panel">
                <!-- GENERAL TIPS -->
                <section id="tips" class="content-section active">
            <h2>ğŸ“‹ General Tips</h2>

            <div class="tip-card">
                <strong>ğŸš¶ Always wander off the path</strong>
                Everything is amazing, and the best part is seeing new things that are not crowded by tons of people.
            </div>

            <div class="tip-card">
                <strong>ğŸ½ï¸ Restaurant Reservations - Tabelog</strong>
                In Japan they use <a href="https://tabelog.com" target="_blank">Tabelog</a> for restaurant reviews and reservations (not Yelp or Google). If you really want to go to a specific restaurant, try to get a reservation a few days before. You cannot get same-day reservations often.
            </div>

            <div class="tip-card">
                <strong>ğŸ‘Ÿ Wear nice shoes, lots of walking</strong>
                Get a room with a bathtub - your body will thank you.
            </div>

            <div class="tip-card">
                <strong>ğŸ’ Pack light</strong>
                Travel with a backpack to carry on the flight and a personal item. You'll be going up and down so many stairs that a roller-bag will probably suck.
            </div>

            <div class="tip-card">
                <strong>ğŸª™ Getting rid of coins</strong>
                Go to a 7-11, buy something and throw all your coins in the slot. It will give you back change if you have more coins than the cost of the item.
            </div>

            <div class="tip-card">
                <strong>ğŸ’´ No tipping anywhere</strong>
                Tipping is considered disrespectful.
            </div>

            <div class="tip-card">
                <strong>ğŸ¤« Be quiet on trains</strong>
                People prefer silence.
            </div>

            <div class="tip-card">
                <strong>ğŸ§´ Always have hand sanitizer</strong>
                Many bathrooms do not have soap.
            </div>

            <div class="tip-card">
                <strong>ğŸ“± GET GOOGLE TRANSLATE</strong>
                You can take pictures of menus, signs, or anything else to translate. You can also download the language so you can use it when you don't have service.
            </div>
        </section>

        <!-- TRAINS -->
        <section id="trains" class="content-section">
            <h2>ğŸš„ Train Travel</h2>

            <div class="tip-card">
                <strong>ğŸ“± Download the Suica app</strong>
                The app is red with flowers. Set up your account and add it to your Apple Wallet. You can use Apple Pay to add money onto your Suica card which is used for trains and subways. It will show your remaining balance. You can also use your Suica funds at convenience stores like Apple Pay. <span class="highlight">Set this up during the flights there or before you leave.</span>
            </div>

            <div class="tip-card">
                <strong>ğŸ« Express Tickets & Reserved Seating</strong>
                Some trains have reserved seating and require an express ticket. You get into the station using your Suica but then need an express ticket. If you don't have a ticket yet, just get on board and buy a ticket from the attendant. <span class="highlight">Do not miss a train just because you don't have a ticket yet.</span> Worst case you end up standing instead of sitting.
            </div>

            <div class="tip-card">
                <strong>ğŸ—ºï¸ Google Maps > Apple Maps</strong>
                Travel by train the entire trip. Google Maps will tell you which platform and car to take. Google Maps is better than Apple Maps.
            </div>
        </section>

        <!-- TOKYO -->
        <section id="tokyo" class="content-section">
            <h2>ğŸ—¼ Tokyo</h2>

            <h3>ğŸ™ï¸ Areas to Explore</h3>

            <div class="location-card">
                <strong>Shinjuku</strong>
                Great area to stay. Love walking around and seeing all the lit-up streets.
                <a href="https://www.google.com/maps/search/Shinjuku+Tokyo+Japan" target="_blank" class="map-link">ğŸ“ View on Map</a>
            </div>

            <div class="location-card">
                <strong>Imperial Palace & Gardens</strong>
                Lots of history, very pretty. Must visit.
                <a href="https://www.google.com/maps/search/Imperial+Palace+Gardens+Tokyo+Japan" target="_blank" class="map-link">ğŸ“ View on Map</a>
            </div>

            <div class="location-card">
                <strong>Shibuya Crossing</strong>
                Cool to see. If you love to shop brand names, it's a good area. Watch the crossing from the Magnet Building - go to the roof floor (pay a cover and get a drink). Also visit Shibuya Scramble Square for the foodie floor.
            </div>

            <div class="location-card">
                <strong>Meiji Jingu Park</strong>
                Beautiful scenery and some shrines. Walk through on the way to Shibuya.
                <a href="https://www.google.com/maps/search/Meiji+Jingu+Park+Tokyo+Japan" target="_blank" class="map-link">ğŸ“ View on Map</a>
            </div>

            <div class="location-card">
                <strong>Golden Gai</strong>
                Tons of cool small bars that seat four to ten people. Different themes for each bar. <span class="highlight">Aces Bar recommended</span> - no cover and the owner is really nice.
                <br>
                <a href="https://tokyocheapo.com/food-and-drink/quick-guide-golden-gai/" target="_blank" class="map-link">ğŸ“– Guide</a>
                <a href="https://www.tripadvisor.com/Restaurant_Review-g14133667-d6180750-Reviews-Ace_s-Kabukicho_Shinjuku_Tokyo_Tokyo_Prefecture_Kanto.html" target="_blank" class="map-link">ğŸ“ Ace's Bar</a>
            </div>

            <h3>ğŸ¨ Hotel</h3>
            <div class="hotel-card">
                <h4>Hotel Gracery (Godzilla Head Hotel)</h4>
                Cool place with a nice location. Super small rooms, but fine because you're out a lot. Close to Omoide Yokocho.
                <br>
                <a href="https://maps.app.goo.gl/wB7UVL3vWLX8919p6" target="_blank" class="map-link">ğŸ“ View on Map</a>
            </div>

            <h3>ğŸœ Food</h3>

            <div class="food-card">
                <h4>Tsurutontan Udon Noodle Brasserie Shibuya</h4>
                Amazing udon place in the Shibuya Scramble Square.
                <br>
                <a href="https://www.tripadvisor.com/Restaurant_Review-g1066456-d19306932-Reviews-Tsurutontan_Udon_Noodle_Brasserie_Shibuya-Shibuya_Tokyo_Tokyo_Prefecture_Kanto.html" target="_blank" class="map-link">ğŸ“ View Details</a>
            </div>

            <div class="food-card">
                <h4>Omoide Yokocho</h4>
                <span class="highlight">YOU HAVE TO GO</span> - Best yakitori stalls. Two streets filled with different food stalls. You can bounce around or stay at one. Great place for pictures. 10/10 recommend. Come back here several times.
                <br>
                <a href="https://maps.app.goo.gl/mF5Cf91j3jeHTRUM6" target="_blank" class="map-link">ğŸ“ View on Map</a>
            </div>

            <div class="food-card">
                <h4>Tsukiji Market</h4>
                Fish, desserts, steak, coffee, matcha, whatever you dream of... it's here. <span class="highlight">Go early.</span> So good.
                <br>
                <a href="https://www.google.com/maps/search/Tsukiji+Market+Tokyo+Japan" target="_blank" class="map-link">ğŸ“ View on Map</a>
            </div>

            <div class="food-card">
                <h4>Yurakucho Kakida</h4>
                Amazing set sushi menu. About 15+ pieces of nigiri. Can feel a bit touristy, but amazing fish and you pay a set amount for food and drinks. They give you so much food - lots of variety. Then you get more pieces of your favorite fish at the end.
                <br>
                <a href="https://maps.app.goo.gl/WS9FgJU68kd6SrD1A" target="_blank" class="map-link">ğŸ“ View on Map</a>
            </div>

            <div class="food-card">
                <h4>Fu-unji Ramen</h4>
                Waited one hour, but really good. Worth it. Lots of locals waiting in line.
                <br>
                <a href="https://www.fu-unji.com/" target="_blank" class="map-link">ğŸŒ Website</a>
            </div>
        </section>

        <!-- KYOTO -->
        <section id="kyoto" class="content-section">
            <h2>â›©ï¸ Kyoto</h2>

            <p style="background: #fff3cd; padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                Yes, it's touristy, but still worth seeing. <strong>Go to tourist sites early in the morning (5-6am)</strong> and then wander or relax the rest of the day without an agenda. Kyoto is broken down into different "districts": Gion, Fushimi Inari, and Arashiyama.
            </p>

            <h3>ğŸ® Gion District</h3>
            <span class="district-tag">Historic</span>
            <span class="district-tag">Temples</span>
            <span class="district-tag">Geisha</span>

            <div class="location-card">
                <strong>HÅkan-ji Temple (Yasaka Pagoda)</strong>
                Go early in the morning or at dusk for less people. Or make a reservation at K36 rooftop bar (long wait without reservation). You can see the Pagoda from the bar - photos and views are stunning.
                <br>
                <a href="https://maps.app.goo.gl/iz7h1MeE2zMN2UaM6" target="_blank" class="map-link">ğŸ“ View on Map</a>
            </div>

            <div class="location-card">
                <strong>Famous Streets</strong>
                <ul>
                    <li><strong>Hanamikoji Street</strong> - Famous Geisha street</li>
                    <li><strong>Sannenzaka</strong></li>
                    <li><strong>Ninenzaka</strong> - At the top of Ninenzaka, there's a building with three white umbrellas. Cool local guy paints miniature paintings for ~100 yen each. You should at least go see him!</li>
                </ul>
                Wander away from these streets to find cool shots, shops, and places to eat.
            </div>

            <div class="location-card">
                <strong>Kiyomizu-dera Temple</strong>
                Amazing temple that overlooks the city. Visit when you're in the Gion area.
                <br>
                <a href="https://maps.app.goo.gl/8g6NaHvfhuiJQRfh6" target="_blank" class="map-link">ğŸ“ View on Map</a>
            </div>

            <p style="background: #f8f9ff; padding: 15px; border-radius: 8px; margin: 20px 0;">
                <strong>Pro Tip:</strong> Wake up early and get to the Gion neighborhood around 6am. It's so peaceful and nice to walk the empty streets without being shoulder to shoulder with people. <span class="highlight">GO EARLY AND GET IT DONE.</span> It's like a half day worth of stuff, all close together in one area.
            </p>

            <h3>ğŸ¨ Hotel</h3>
            <div class="hotel-card">
                <h4>Crystal Gion Hotel</h4>
                Loved this hotel - affordable and in old town Gion. About 12-minute walk from Yasaka Pagoda. Close to subway/train station. Stayed four nights and went to other districts. Breakfast included!
                <br>
                <a href="https://www.google.com/maps/search/Crystal+Gion+Hotel+Kyoto+Japan" target="_blank" class="map-link">ğŸ“ View on Map</a>
            </div>

            <h3>ğŸ£ Food - Gion Area</h3>

            <div class="food-card">
                <h4>Hanamichi</h4>
                Cute lady runs this restaurant, and the food is so good.
                <br>
                <a href="https://maps.app.goo.gl/kRLaGHZK7Ca6pH7R7" target="_blank" class="map-link">ğŸ“ View on Map</a>
            </div>

            <div class="food-card">
                <h4>Lorimer Kyoto</h4>
                Wild brunch with fish and tons of random seasonal samples.
                <br>
                <a href="https://www.google.com/maps/search/Lorimer+Kyoto+Japan" target="_blank" class="map-link">ğŸ“ View on Map</a>
            </div>

            <div class="food-card">
                <h4>Sushi and Bar Spot</h4>
                Near Gion hotel. $100 omakase with a bar that seats about ten people. <span class="highlight">100% recommend.</span> Fish and sushi chef were amazing.
                <br>
                <a href="https://maps.app.goo.gl/boHjxe9wTS6c5oBD6" target="_blank" class="map-link">ğŸ“ View on Map</a>
            </div>

            <div class="food-card">
                <h4>Nishiki Market</h4>
                Souvenirs, fish, meat, desserts, all in a market. Pretty cool to check out. Had some of the best clams and scallops - they're everywhere.
                <br>
                <a href="https://www.google.com/maps/search/Nishiki+Market+Kyoto+Japan" target="_blank" class="map-link">ğŸ“ View on Map</a>
            </div>

            <div class="food-card">
                <h4>Pontocho District</h4>
                Small alley way with a ton of cool restaurants and bars.
                <br>
                <a href="https://www.google.com/maps/search/Pontocho+District+Kyoto+Japan" target="_blank" class="map-link">ğŸ“ View on Map</a>
            </div>

            <div class="food-card">
                <h4>Pontocho-noichi (Kobe Beef)</h4>
                Pricey, but if you want certified Kobe beef, this is a good spot for it.
                <br>
                <a href="https://kisshokichi-kyoto.com/pontochonoichi/" target="_blank" class="map-link">ğŸŒ Website</a>
            </div>

            <h3>ğŸ‹ Arashiyama District</h3>
            <span class="district-tag">Bamboo Forest</span>
            <span class="district-tag">Nature</span>
            <span class="district-tag">Monkeys</span>

            <div class="location-card">
                <strong>Monkey Park & Bamboo Forest</strong>
                Bamboo forest has a cool park on the side that's way better than the bamboo forest itself. Walk down along the water if you keep going south past the park - so pretty and highly recommend. The monkey park is a hike up the mountain to an overlook of the city. Beautiful views and free-roaming monkeys. Lots of shops and restaurants. Got beers and walked around.
                <a href="https://www.google.com/maps/search/Arashiyama+Monkey+Park+Bamboo+Forest+Kyoto+Japan" target="_blank" class="map-link">ğŸ“ View on Map</a>
            </div>

            <div class="food-card">
                <h4>Taisho Hanana - Sea Bream Sashimi</h4>
                <span class="highlight">YOU HAVE TO GO TO.</span> So good. There will probably be a line but grab a beer from a 7-11 and wait in line. It is so worth it.
                <br>
                <a href="https://maps.app.goo.gl/XEGE148kmfDx5Jdu8" target="_blank" class="map-link">ğŸ“ View on Map</a>
            </div>

            <h3>ğŸ¦Š Fushimi Inari District</h3>
            <span class="district-tag">Torii Gates</span>
            <span class="district-tag">Shrine</span>
            <span class="district-tag">Hiking</span>

            <div class="location-card">
                <strong>Fushimi Inari Shrine</strong>
                Loved it! Uphill hike with tons of orange torii gates. Super busy with tourists, but there are paths you can go down that are less crowded. Look for areas with random torii gates and no one around. Found abandoned areas where we were completely alone. Look for paths marked "not a through loop" - they turn into cool hikes that pop out into residential areas. Tons of street food and shops at the bottom.
                <a href="https://www.google.com/maps/search/Fushimi+Inari+Shrine+Kyoto+Japan" target="_blank" class="map-link">ğŸ“ View on Map</a>
            </div>

            <div class="food-card">
                <h4>Inari Douhachi</h4>
                Really good and cheap udon in Fushimi Inari area.
                <br>
                <a href="https://maps.app.goo.gl/wdDCpFcVHFu63qVF8" target="_blank" class="map-link">ğŸ“ View on Map</a>
            </div>
        </section>

        <!-- KINOSAKI -->
        <section id="kinosaki" class="content-section">
            <h2>â™¨ï¸ Kinosaki</h2>

            <p style="background: #fff3cd; padding: 15px; border-radius: 8px; margin-bottom: 20px; font-size: 1.1em;">
                <strong>One of my favorite places in Japan. Seriously, you have to go.</strong> It's an onsen town with seven public onsens that are gender separated. You could book a private onsen for ~$60. Did not want to leave. So calm and quiet. Beautiful scenery.
            </p>

            <div class="hotel-card">
                <h4>Nishimuraya Hotel</h4>
                Spent more at this onsen hotel that had two of its own private onsens in the lobby with a sauna and cold plunge. Stayed two nights. This was a lifesaver after walking around Kyoto and Tokyo - our bodies were hurting. This town is quiet and sooo pretty. It's pricey, but you won't regret it. The chef's seasonal dinner was one of the best meals we had.
                <br><br>
                <strong>Recommendation:</strong> Do two nights at Nishimuraya Hotel and then move to another hotel in town for another night or two. Loved being able to relax and not run all over the place.
                <br>
                <a href="https://www.google.com/maps/search/Nishimuraya+Hotel+Kinosaki+Japan" target="_blank" class="map-link">ğŸ“ View on Map</a>
            </div>

            <h3>ğŸ”ï¸ Activities</h3>

            <div class="location-card">
                <strong>Cable Car to Mountain Top</strong>
                Took a cable car up to the top of the mountain and walked down. There's a cafÃ© at the top where you can get coffees, beers, and hot dogs (hot dogs are a big thing in Japan).
                <a href="https://www.google.com/maps/search/Kinosaki+Onsen+Ropeway+Cable+Car+Japan" target="_blank" class="map-link">ğŸ“ View on Map</a>
            </div>

            <h3>ğŸ• Food</h3>

            <div class="food-card">
                <h4>Gina Pizza</h4>
                A great Italian place with some great pasta and pizza.
                <br>
                <a href="https://www.google.com/maps/place/462+Kinosakich%C5%8D+Yushima,+Toyooka,+Hyogo+669-6101,+Japan/@35.6254376,134.806381,17z" target="_blank" class="map-link">ğŸ“ View on Map</a>
            </div>
        </section>

        <!-- OSAKA -->
        <section id="osaka" class="content-section">
            <h2>ğŸ¯ Osaka</h2>

            <p style="background: #f8f9ff; padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                Stay in the <strong>Namba area</strong> if you want to be close to Dotonburi and Kuromon Market. Amazing city to eat a lot of good food. They have whale sharks at the aquarium (buy tickets in advance or wait ~2 hours).
            </p>

            <div class="hotel-card">
                <h4>APA Namba Ekamai Hotel</h4>
                Too many people, heat wouldn't turn off. Super small room, but barely there so it was fine. Would not book here again at this specific hotel but loved the location. If you can stay in this area, you should.
                <br>
                <a href="https://www.google.com/maps/search/APA+Namba+Ekamai+Hotel+Osaka+Japan" target="_blank" class="map-link">ğŸ“ View on Map</a>
            </div>

            <h3>ğŸ¢ Dotonburi (Insane Food District)</h3>
            <span class="district-tag">Street Food</span>
            <span class="district-tag">Must Visit</span>

            <p style="margin: 15px 0;">Ended up spending a lot of time here because of all the amazing food options.</p>

            <div class="food-card">
                <h4>Teppan Jinja (Teppan-grilled skewers)</h4>
                <span class="highlight">MUST TRY</span> - Seriously so good if you want different beef, chicken, pork options. <strong>Went here twice because the hype is real.</strong>
                <br>
                <a href="https://maps.app.goo.gl/oZA1gKZa3yrzASRz8" target="_blank" class="map-link">ğŸ“ View on Map</a>
            </div>

            <div class="food-card">
                <h4>Street Food (Dotonburi)</h4>
                Can't go wrong with the street food here. Tried a lot of places. <strong>Takoyaki and pufferfish are huge here.</strong> Takoyaki places have huge octopus sculptures on the outside. Good stand right next to Teppan Jinja.
                <br>
                <a href="https://www.google.com/maps/search/Dotonburi+Street+Food+Osaka+Japan" target="_blank" class="map-link">ğŸ“ View on Map</a>
            </div>

            <h3>ğŸŸ Osaka Kuromon Market</h3>
            <span class="district-tag">Best Market Ever</span>
            <span class="district-tag">Fresh Fish</span>

            <div class="food-card">
                <h4>Suehiro</h4>
                Great sushi and hand rolls. Has a grab-and-go or sit down at the bar.
                <br>
                <a href="https://maps.app.goo.gl/KLm6x9DAAkLwQVFR9" target="_blank" class="map-link">ğŸ“ View on Map</a>
                <br>
                <small>21-33, Nippombashi 1-ChÅme, Chuo, Osaka</small>
            </div>

            <div class="food-card">
                <h4>Entoki Kuromon</h4>
                <span class="highlight">BEST TUNA</span> - Serves nigiri sampler of different parts of the tuna. <strong>This booth will live in my mind and heart until the end of time.</strong>
                <br>
                <a href="https://maps.app.goo.gl/M8eTX6B1BPgQPQSa6" target="_blank" class="map-link">ğŸ“ View on Map</a>
                <a href="https://entoki.com/" target="_blank" class="map-link">ğŸŒ Website</a>
            </div>

            <p style="margin-top: 15px;">Ate at so many stalls. The above two were favorites. Everything else was good, but not as amazing as those.</p>
        </section>

        <!-- KANAZAWA -->
        <section id="kanazawa" class="content-section">
            <h2>ğŸ° Kanazawa</h2>

            <p style="background: #fff3cd; padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                <strong>Would go back to Kanazawa again.</strong> It's beautiful and is like a less crowded Kyoto. If you don't want to go to a tourist city, go here! There's a massive castle in the middle of the city - Kanazawa Castle. You can tour different parts of it and buy tickets to a garden next to it that is stunning.
            </p>

            <div class="location-card">
                <strong>Kanazawa Castle</strong>
                Tour the castle and visit the stunning garden next to it.
                <br>
                <a href="https://maps.app.goo.gl/PfDwtB21FuRiFfae8" target="_blank" class="map-link">ğŸ“ View on Map</a>
            </div>

            <h3>ğŸ¨ Hotel</h3>
            <div class="hotel-card">
                <h4>Tokyu Stay Kanazawa</h4>
                Loved it and it was super affordable. The location was good too.
                <br>
                <a href="https://www.google.com/maps/search/Tokyu+Stay+Kanazawa+Japan" target="_blank" class="map-link">ğŸ“ View on Map</a>
                <a href="https://www.google.com/travel/search?ts=CAEaSQopEicyJTB4NWZmODMzNmZjYTc0NTJiZjoweGRjMzhkYjkyMWJlYWMzNzESHBIUCgcI6Q8QBxgbEgcI6Q8QBxgcGAEyBAgAEAAqBwoFOgNVU0Q" target="_blank" class="map-link">ğŸŒ View Hotel</a>
            </div>

            <h3>ğŸ· Food & Drink</h3>

            <div class="food-card">
                <h4>Uva Uva (Italian/Japanese Fusion)</h4>
                Found this place wandering. Italian/Japanese fusion with set menu and seasonal ingredients. Italian sashimi and tempura. Squid pomodoro was good. The owner is a cute lady who is a sommelier and showed great wines.
                <br>
                <a href="https://uvauva-romanza.jp" target="_blank" class="map-link">ğŸŒ Website</a>
                <a href="https://maps.app.goo.gl/tWkANjJui7gXxfE69" target="_blank" class="map-link">ğŸ“ View on Map</a>
            </div>

            <div class="food-card">
                <h4>Ramen Mikoshi</h4>
                Was okay.
                <br>
                <a href="https://maps.app.goo.gl/eNz3MgzFC1qVyQVEA" target="_blank" class="map-link">ğŸ“ View on Map</a>
            </div>

            <div class="food-card">
                <h4>Furansu Cocktail Bar</h4>
                <a href="https://maps.app.goo.gl/9VQVbYkng9vMkxoJ6" target="_blank" class="map-link">ğŸ“ View on Map</a>
            </div>

            <h3>ğŸ¶ Higashi Chaya District</h3>
            <span class="district-tag">Old Town</span>
            <span class="district-tag">Sake</span>

            <div class="location-card">
                <strong>Higashi Chaya District</strong>
                An old town district with shops, bars, and restaurants. There's a river that runs by it that's beautiful to walk down. Did a sake tasting and got Donburi bowls.
                <a href="https://www.google.com/maps/search/Higashi+Chaya+District+Kanazawa+Japan" target="_blank" class="map-link">ğŸ“ View on Map</a>
            </div>

            <div class="food-card">
                <h4>Fukumitsuya Higashi (Sake Bar)</h4>
                <a href="https://maps.app.goo.gl/dkmm6chdRkLFs9cF8" target="_blank" class="map-link">ğŸ“ View on Map</a>
            </div>

            <div class="food-card">
                <h4>Higashiyama Yoshi (Donburi Bowls)</h4>
                So good!
                <br>
                <a href="https://maps.app.goo.gl/MqEARfKoKxf56u6h9" target="_blank" class="map-link">ğŸ“ View on Map</a>
            </div>
        </section>
            </div>
            <!-- End of Content Panel -->

            <!-- RIGHT: Map Panel (sticky) -->
            <div class="map-panel">
                <div class="map-header">
                    <h3 class="map-title" id="map-title">Japan Overview</h3>
                    <p class="map-subtitle" id="map-subtitle">Select a city to view locations</p>
                </div>
                <div id="main-map" class="map-container"></div>
            </div>
        </div>
        <!-- End of Main Layout -->
    </div>

    <script>
        function showSection(sectionId) {
            // Hide all sections
            const sections = document.querySelectorAll('.content-section');
            sections.forEach(section => {
                section.classList.remove('active');
            });

            // Remove active class from all buttons
            const buttons = document.querySelectorAll('.nav-btn');
            buttons.forEach(button => {
                button.classList.remove('active');
            });

            // Show selected section
            document.getElementById(sectionId).classList.add('active');

            // Add active class to clicked button
            event.target.classList.add('active');

            // Update map for the selected section
            updateMapForSection(sectionId);

            // Scroll to top
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function updateMapForSection(sectionId) {
            const cityMap = {
                'tokyo': 'tokyo',
                'kyoto': 'kyoto',
                'osaka': 'osaka',
                'kinosaki': 'kinosaki',
                'kanazawa': 'kanazawa'
            };

            const mapTitle = document.getElementById('map-title');
            const mapSubtitle = document.getElementById('map-subtitle');

            if (cityMap[sectionId]) {
                const cityName = sectionId.charAt(0).toUpperCase() + sectionId.slice(1);
                mapTitle.textContent = `${cityName} Locations`;

                const locations = cityLocations[sectionId];
                mapSubtitle.textContent = `${locations.length} places to visit`;

                updateMapForCity(sectionId);
            } else {
                // Non-city sections (tips, trains, itinerary-planner, budget-tracker)
                mapTitle.textContent = 'Japan Overview';
                mapSubtitle.textContent = 'Select a city to view locations';

                // Reset to Japan overview
                if (mainMapInstance) {
                    mainMapInstance.flyTo([36.2048, 138.2529], 6, {
                        duration: 1.5,
                        easeLinearity: 0.25
                    });
                    currentCityMarkers.forEach(marker => marker.remove());
                    currentCityMarkers = [];
                }
            }
        }

        // Search functionality
        const searchBox = document.getElementById('searchBox');
        searchBox.addEventListener('input', function(e) {
            const searchTerm = e.target.value.toLowerCase();
            const sections = document.querySelectorAll('.content-section');

            if (searchTerm === '') {
                // Reset to show only tips section if search is empty
                sections.forEach(section => section.classList.remove('active'));
                document.getElementById('tips').classList.add('active');
                return;
            }

            sections.forEach(section => {
                const content = section.textContent.toLowerCase();
                if (content.includes(searchTerm)) {
                    section.classList.add('active');
                } else {
                    section.classList.remove('active');
                }
            });
        });
    </script>
    <script src="config.js"></script>
    <script src="supabase-client.js"></script>
    <script src="supabase-data.js"></script>
    <script src="auth.js"></script>
    <script src="ui-components.js"></script>
    <script src="itinerary.js"></script>
    <script src="budget.js"></script>
    <script src="photos.js"></script>
    <script src="maps.js"></script>
    <script>
        async function handleLogin(event) {
            const emailInput = document.getElementById('email-input');
            const authMessage = document.getElementById('auth-message');
            const button = event.target;
            const email = emailInput.value.trim();

            if (!email) {
                authMessage.textContent = 'Please enter your email';
                authMessage.style.color = 'var(--accent-secondary)';
                return;
            }

            // Basic email validation
            if (!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) {
                authMessage.textContent = 'Please enter a valid email';
                authMessage.style.color = 'var(--accent-secondary)';
                return;
            }

            // Add loading state - disable button and show "Sending..."
            const originalText = button.textContent;
            button.disabled = true;
            button.textContent = 'Sending...';

            try {
                await auth.sendMagicLink(email);
                authMessage.textContent = 'Check your email for the magic link!';
                authMessage.style.color = 'var(--accent-primary)';
                emailInput.value = '';
            } catch (error) {
                authMessage.textContent = `Error: ${error.message}`;
                authMessage.style.color = 'var(--accent-secondary)';
            } finally {
                // Re-enable button and restore text
                button.disabled = false;
                button.textContent = originalText;
            }
        }

        async function handleLogout() {
            try {
                await auth.signOut();
            } catch (error) {
                alert(`Error logging out: ${error.message}`);
            }
        }

        async function loadData() {
            try {
                await dataManager.load();
                console.log('Data loaded successfully:', dataManager.data);
                renderUI();
            } catch (error) {
                console.error('Failed to load data:', error);
                alert('Failed to load data. Make sure the repository exists and you have access.');
            }
        }

        async function saveData() {
            if (!auth.isAuthenticated()) {
                alert('Please log in to save changes');
                return;
            }

            try {
                await dataManager.save();
                alert('Changes saved successfully!');
            } catch (error) {
                alert(`Error saving: ${error.message}`);
            }
        }

        function renderUI() {
            if (!dataManager.data) return;
            addInteractiveFeatures();
            renderAllBudgetCategories();

            // Render all photos
            document.querySelectorAll('.location-card, .food-card, .hotel-card').forEach(card => {
                const titleElement = card.querySelector('strong, h4');
                if (!titleElement) return;

                const locationId = titleElement.textContent
                    .toLowerCase()
                    .replace(/[^a-z0-9]+/g, '-')
                    .replace(/^-|-$/g, '');

                renderPhotosForLocation(locationId);
            });
        }

        // Initialize on page load
        window.addEventListener('DOMContentLoaded', async () => {
            // Initialize auth FIRST
            await auth.init();

            // Initialize data AFTER auth is ready
            if (auth.isAuthenticated()) {
                await loadData();

                // Subscribe to real-time changes
                dataManager.subscribeToChanges((newData) => {
                    console.log('Data synced from another user');
                    // Refresh UI with new data
                    renderUI();
                });
            }

            // Add itinerary section after Kanazawa section
            const kanazawaSection = document.getElementById('kanazawa');
            const itinerarySection = createItinerarySection();
            kanazawaSection.parentNode.insertBefore(itinerarySection, kanazawaSection.nextSibling);

            // Add budget section after itinerary section
            const budgetSection = createBudgetSection();
            itinerarySection.parentNode.insertBefore(budgetSection, itinerarySection.nextSibling);
        });
    </script>
</body>
</html>
